#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üîç Ejecutando verificaciones pre-commit con Husky para httplazy..."

# Ejecutar lint-staged para verificar los archivos staged
npx lint-staged

# Verificar dependencias circulares
echo "üìä Verificando dependencias circulares..."
npx madge --circular http/ ||
(
  echo "‚õî Se detectaron dependencias circulares. Ejecuta 'npx madge --circular http/' para m√°s detalles."
  exit 1
)

# Verificar reglas de exportaci√≥n (no usar export default)
echo "üì¶ Verificando reglas de exportaci√≥n..."
grep -r "export default" http/ --include="*.ts" | grep -v "node_modules" > /dev/null
if [ $? -eq 0 ]; then
  echo "‚ö†Ô∏è Advertencia: Se encontraron usos de 'export default'. Considera usar exportaciones nombradas."
fi

echo "‚úÖ Todas las verificaciones pasaron correctamente."
